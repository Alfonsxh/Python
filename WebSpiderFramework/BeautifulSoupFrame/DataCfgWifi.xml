<?xml version="1.0" encoding="utf-8"?>
<!--回传设备数据库-->
<FeedbackDB>
    <!--与设备相关IP，正式发布时为127.0.0.1-->
    <DataBase host="127.0.0.1" port="3306" dbname="wifilz" username="root" password="ygwifidb_password" charset="utf8"/>

    <!--实体文件存储目录-->
    <!--<EntityDir>/.ygoutput/ygproto/entity/</EntityDir>-->

    <DataUpload>/rest/Upload</DataUpload>       <!--回传服务器地址需指定-->

    <!--FeedbackData：type属性为所要回传的信息类型
        NetID:  回传虚拟身份数据
        Http:   回传Http数据
        DNS:    回传DNS数据
        Scanap: 回传上下线数据
        Software:回传软件数据
        Im:     回传即时通讯数据
        Vpn:    回传VPN通讯数据-->
    <!--Table里KeyWords、Condition标签只能有一个-->
    <!-- AssociativeTable 为关联查询表，仅当出现关联查询时使用 -->
    <!--
        field：对应于数据库中的field，这类数据来源于数据库，没有field字段都必须使用defaultValue；
        type: 指定需要将数据库中的字段进行对应的转换，为空时不做任何转换，默认为空
            decodeProType 转换加密方式，OPN/WEP/WPA2
            mac2vendor    转换成mac厂商信息
            datetime2str    指定 数据库中的datetime类型转换为时间字符串
            datetime2int     指定 数据库中的datetime类型转换为int时间戳
            inttime2str       指定 数据库中的整数时间类型（EPOCH时间戳，到秒）转换为时间字符串
            htons              指定 数据库中的2字节整数，调整字节序，仍然为整数
            htonl              指定 数据库中的4字节整数，调整字节序，仍然为整数
            ip2int              指定 数据库中的ip点分十进制字符串转还为int类型
            file:               指定数据库字段是否为实体文件路径字段，1为文件，0不是文件，默认为0。
            defaultValue：数据库中没有该字段的值时有效，指定所设的默认值，defaultValue默认为""
            dtype:            指定需要将defaultValue转换为其它类型，为空时不转换，为字符串，默认为空
            int                  指定defaultValue的字符串转为整数值。-->
    <!--Key标签中的ID关键字为数据库中的主键，配置文件中需提供，传输时不显示-->
    <!--condition:sql语句的条件参数-->

    <!--回传虚拟身份数据-->
    <FeedbackData type="NetID">
        <Table name="node_netid" num="1">
            <KeyWords mainKey='ID'>
                <!--数据库表的主键-->
                <Key field="Mac">mac</Key>                    <!--Mac地址-->
                <Key field="SrvHost">srvHost</Key>            <!--服务端域名-->
                <Key field="IdType" type="int">idType</Key>              <!--指定虚拟身份的类型-->
                <Key field="UserName">userName</Key>          <!--用户名-->
                <Key field="Password">password</Key>          <!--用户密码-->
                <Key field="Time" type="datetime2int">time</Key>    <!--时间-->
            </KeyWords>
            <Condition><![CDATA[where UserName is not NULL and UserName <> '']]></Condition>
        </Table>
        <Table name="node_devinfo" num="2">
            <KeyWords mainKey='ID'>
                <Key field="Mac">mac</Key>                    <!--Mac地址-->
                <Key field="Imei">userName</Key>              <!--用户名-->
                <Key field="Time" type="datetime2int">time</Key>              <!--时间-->
                <Key defaultValue="2" dtype="int">idType</Key> <!--指定虚拟身份的类型-->
                <Key defaultValue="">password</Key>                   <!--用户密码-->
                <Key defaultValue="">srvHost</Key>                     <!--服务端域名-->
            </KeyWords>
            <Condition><![CDATA[where Imei is not NULL and Imei <> '']]></Condition>
        </Table>
        <Table name="node_devinfo" num="3">
            <KeyWords mainKey='ID'>
                <Key field="Mac">mac</Key>                      <!--Mac地址-->
                <Key field="Imsi">userName</Key>                <!--用户名-->
                <Key field="Time" type="datetime2int">time</Key><!--时间-->
                <Key defaultValue="3" dtype="int">idType</Key>  <!--指定虚拟身份的类型-->
                <Key defaultValue="">password</Key>             <!--用户密码-->
                <Key defaultValue="">srvHost</Key>              <!--服务端域名-->
            </KeyWords>
            <Condition><![CDATA[where Imsi is not NULL and Imsi <> '']]></Condition>
        </Table>
        <Table name="jx_logging" num="4">
            <KeyWords mainKey='ID'>
                <Key field="Mac">mac</Key>                   <!--Mac地址-->
                <Key field="WebSite">srvHost</Key>           <!--服务端域名-->
                <Key field="IdType" type="int">idType</Key>             <!--指定虚拟身份的类型-->
                <Key field="UserName">userName</Key>         <!--用户名-->
                <Key field="PassWord">password</Key>         <!--用户密码-->
                <Key field="CaptureTime" type="int">time</Key> <!--时间-->
            </KeyWords>
            <Condition><![CDATA[where UserName is not NULL and UserName <> '']]></Condition>
        </Table>
    </FeedbackData>

    <!--回传Http数据-->
    <FeedbackData type="Http">
        <Table name="jx_httpcookie" num="1">
            <KeyWords mainKey='ID'>
                <Key field="ProtocolID" type="int">protocolId</Key>                 <!-- '协议号',-->
                <Key field="SrcIP" type="htonl">srcIp</Key>                           <!-- '本方IP,网络序',-->
                <Key field="SrcPort" type="htons">srcPort</Key>          <!-- '本方端口,网络序',-->
                <Key field="DstIP" type="htonl">dstIp</Key>                           <!-- '对方IP,网络序',-->
                <Key field="DstPort" type="htons">dstPort</Key>          <!-- '对方端口,网络序',-->
                <Key field="CaptureTime" type="int">captureTime</Key>               <!-- `CaptureTime`-->
                <Key field="MAC">mac</Key>                               <!-- '本方MAC',-->
                <Key field="URL">url</Key>                               <!-- `URL` -->
                <Key field="HostName">hostName</Key>                     <!-- '主机名',-->
                <Key field="Referer">referer</Key>                       <!-- '调用此页面的上层页面URL',-->
                <Key field="Title">title</Key>                           <!-- '标题',-->
                <Key field="Cookie">cookie</Key>                         <!-- `Cookie` varchar(4000) DEFAULT NULL,-->
                <Key field="TransFileName">transFileName</Key>  <!-- '实体文件名',-->
                <Key field="FileSize" type="int">fileSize</Key>                     <!-- '实体文件的大小',-->
            </KeyWords>
            <Condition></Condition>
        </Table>
    </FeedbackData>

    <!--回传DNS数据-->
    <FeedbackData type="DNS">
        <Table name="jx_dns" num="1">
            <KeyWords mainKey='ID'>
                <Key field="ProtocolID" type="int">protocolId</Key>                <!--'协议号',-->
                <Key field="SrcIP" type="htonl">srcIp</Key>                          <!--'本方IP,网络序',-->
                <Key field="SrcPort" type="htons">srcPort</Key>                      <!--'本方端口,网络序',-->
                <Key field="DstIP" type="htonl">dstIp</Key>                          <!--'对方IP,网络序',-->
                <Key field="DstPort" type="htons">dstPort</Key>                      <!--'对方端口,网络序',-->
                <Key field="CaptureTime" type="int">captureTime</Key>              <!--`CaptureTime`,-->
                <Key field="MAC">mac</Key>                              <!--'本方MAC',-->
                <Key field="Host">host</Key>                           <!--'DNS访问域名',-->
                <Key field="HostIp" type="htonl">hostIp</Key>                       <!--'服务器返回的IP地址',-->
            </KeyWords>
            <Condition></Condition>
        </Table>
    </FeedbackData>

    <!--回传软件使用数据-->
    <FeedbackData type="Software">
        <Table name="node_softwareinfo" num="1">
            <KeyWords mainKey='ID'>
                <Key field="Mac">mac</Key>                    <!--mac地址-->
                <Key field="Time" type="datetime2int">time</Key>              <!--时间-->
                <Key field="WareName">wareName</Key>          <!--软件名字-->
            </KeyWords>
            <Condition></Condition>
        </Table>
        <Table name="node_devinfo" num="2">
            <KeyWords mainKey='ID'>
                <Key field="Mac">mac</Key>                    <!--mac地址-->
                <Key field="Time" type="datetime2int">time</Key>              <!--时间-->
                <Key field="Device">wareName</Key>            <!--设备名字（软件名字）-->
            </KeyWords>
            <Condition><![CDATA[where Device is not NULL and Device <> '']]></Condition>
        </Table>
    </FeedbackData>

    <!--回传即时聊天数据-->
    <FeedbackData type="Im">
        <Table name="jx_im" num="1">
            <KeyWords mainKey='ID'>
                <Key field="ProtocolID" type="int">protocolId</Key>                <!--'协议号',-->
                <Key field="SrcIP" type="htonl">srcIp</Key>                          <!--'本方IP,网络序',-->
                <Key field="SrcPort" type="htons">srcPort</Key>                      <!--'本方端口,网络序',-->
                <Key field="DstIP" type="htonl">dstIp</Key>                          <!--'对方IP,网络序',-->
                <Key field="DstPort" type="htons">dstPort</Key>                      <!--'对方端口,网络序',-->
                <Key field="CaptureTime" type="int">captureTime</Key>              <!--`CaptureTime`,-->
                <Key field="MAC">mac</Key>                              <!--'本方MAC',-->
                <Key field="SendTime" type="int">sendTime</Key>                   <!--'时间',-->
                <Key field="NickName">nickName</Key>                   <!--'昵称',-->
                <Key field="FromUser">fromUser</Key>                   <!--'发送者',-->
                <Key field="FromNickName">fromNickName</Key>           <!--'发送者昵称',-->
                <Key field="ToUser">toUser</Key>                       <!--'接收者',-->
                <Key field="ToNickName">toNickName</Key>               <!--`ToNickName`,-->
                <Key field="GroupNo">groupNo</Key>                     <!--'群号',-->
                <Key field="GroupName">groupName</Key>                 <!--'群名称',-->
                <Key field="Action" type="int">action</Key>                       <!--'即时信息动作类型',-->
                <Key field="Content">content</Key>                     <!--'内容',-->
                <Key field="TransFileName">transFileName</Key>         <!--'传输文件名，多个文件以|分隔',-->
                <Key field="Username">userName</Key>                   <!--'用户名',-->
                <Key field="Password">password</Key>                   <!--'密码',-->
            </KeyWords>
            <Condition></Condition>
        </Table>
    </FeedbackData>
	
	<!--回传VPN使用信息-->
	<FeedbackData type="Vpn">
		<Table name="node_vpn" num="1">
            <KeyWords mainKey='ID'>
                <Key field="Mac">mac</Key>                    <!--mac地址-->
                <Key field="Time" type="datetime2int">time</Key>              <!--时间-->
                <Key field="ProtocolId" type="int">protocolId</Key>            <!--协议号-->
                <Key field="Action" type="int">action</Key>            <!--VPN使用动作，0离线，1上线，2使用-->
                <Key field="Server" type="ip2int">srvIp</Key>            <!--服务器地址-->
            </KeyWords>
            <Condition></Condition>
		</Table>
	</FeedbackData>

    <!--回传flow使用信息-->
	<FeedbackData type="FlowInfo">
		<Table name="jx_flow" num="1">
            <KeyWords mainKey='ID'>
                <Key field="ProtocolId" type="int">protocolId</Key>         <!--协议号-->
                <Key field="Mac">mac</Key>                                  <!--mac地址-->
                <Key field="ClientIp" type="htonl">clientIp</Key>             <!--客户端Ip-->
                <Key field="ClientPort" type="htons">clientPort</Key>         <!--客户端端口-->
                <Key field="SrvIp" type="htonl">srvIp</Key>                   <!--服务端Ip-->
                <Key field="SrvPort" type="htons">srvPort</Key>               <!--服务端端口-->
                <Key field="SrvHost">srvHost</Key>                          <!--服务端域名-->
                <Key field="StartTime" type="int">startTime</Key>           <!--开始时间-->
                <Key field="EndTime" type="int">endTime</Key>               <!--结束时间-->
                <Key field="Bytes" type="int">bytes</Key>                   <!--流量大小-->
            </KeyWords>
            <Condition></Condition>
		</Table>
	</FeedbackData>
</FeedbackDB>

